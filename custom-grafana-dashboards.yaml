# Create configMap that will be detected and deployed by the grafana sidecar
# Create one ConfigMap per Dashboard
# https://github.com/grafana/helm-charts/tree/main/charts/grafana#sidecar-for-dashboards

apiVersion: v1
data:
  ee-scheduling.json: '{"annotations": {"list": [{"builtIn": 1,"datasource": {"type": "grafana","uid": "-- Grafana --"},"enable": true,"hide": true,"iconColor": "rgba(0, 211, 255, 1)","name": "Annotations & Alerts","type": "dashboard"}]},"editable": true,"fiscalYearStartMonth": 0,"graphTooltip": 0,"id": 24,"links": [],"panels": [{"collapsed": false,"gridPos": {"h": 1,"w": 24,"x": 0,"y": 0},"id": 3,"panels": [],"title": "Nodes","type": "row"},{"datasource": {"type": "prometheus","uid": "${ds}"},"fieldConfig": {"defaults": {"color": {"mode": "palette-classic"},"custom": {"axisBorderShow": false,"axisCenteredZero": false,"axisColorMode": "text","axisLabel": "","axisPlacement": "auto","barAlignment": 0,"barWidthFactor": 0.6,"drawStyle": "line","fillOpacity": 0,"gradientMode": "none","hideFrom": {"legend": false,"tooltip": false,"viz": false},"insertNulls": false,"lineInterpolation": "smooth","lineWidth": 1,"pointSize": 5,"scaleDistribution": {"type": "linear"},"showPoints": "auto","spanNulls": false,"stacking": {"group": "A","mode": "none"},"thresholdsStyle": {"mode": "off"}},"fieldMinMax": false,"mappings": [{"options": {"10.10.1.1:9100": {"index": 0,"text": "a"}},"type": "value"}],"thresholds": {"mode": "absolute","steps": [{"color": "green","value": null}]},"unit": "watt"},"overrides": []},"gridPos": {"h": 4,"w": 24,"x": 0,"y": 1},"id": 4,"options": {"legend": {"calcs": [],"displayMode": "list","placement": "right","showLegend": true,"width": 250},"tooltip": {"mode": "single","sort": "none"}},"pluginVersion": "11.4.0","targets": [{"datasource": {"type": "prometheus","uid": "${ds}"},"editorMode": "code","expr": "node_ipmi_power_watts{node_name=~\"$no\"}","interval": "","legendFormat": "{{instance}}","range": true,"refId": "A"}],"title": "Power Constumption (Watt)","transformations": [{"id": "renameByRegex","options": {"regex": "(10.10.1.\\d+):9100","renamePattern": "$1"}}],"type": "timeseries"},{"collapsed": false,"gridPos": {"h": 1,"w": 24,"x": 0,"y": 5},"id": 2,"panels": [],"title": "Pods","type": "row"},{"datasource": {"type": "prometheus","uid": "${ds}"},"fieldConfig": {"defaults": {"color": {"mode": "palette-classic"},"custom": {"axisBorderShow": false,"axisCenteredZero": false,"axisColorMode": "text","axisLabel": "","axisPlacement": "auto","barAlignment": 0,"barWidthFactor": 0.6,"drawStyle": "line","fillOpacity": 0,"gradientMode": "none","hideFrom": {"legend": false,"tooltip": false,"viz": false},"insertNulls": false,"lineInterpolation": "linear","lineWidth": 1,"pointSize": 5,"scaleDistribution": {"type": "linear"},"showPoints": "auto","spanNulls": false,"stacking": {"group": "A","mode": "none"},"thresholdsStyle": {"mode": "off"}},"mappings": [],"thresholds": {"mode": "absolute","steps": [{"color": "green","value": null},{"color": "red","value": 80}]},"unit": "bytes"},"overrides": []},"gridPos": {"h": 12,"w": 24,"x": 0,"y": 6},"id": 1,"options": {"legend": {"calcs": [],"displayMode": "list","placement": "right","showLegend": true,"width": 250},"tooltip": {"mode": "single","sort": "none"}},"pluginVersion": "11.4.0","targets": [{"datasource": {"type": "prometheus","uid": "${ds}"},"editorMode": "code","expr": "sum(container_memory_working_set_bytes{job=\"kubelet\", metrics_path=\"/metrics/cadvisor\", cluster=\"\", namespace=~\"$ns\", pod=~\"$pod\"}) by (pod)","interval": "1m","legendFormat": "__auto","range": true,"refId": "A"}],"title": "Memory Usage (w/o cache)","type": "timeseries"}],"preload": false,"schemaVersion": 40,"tags": [],"templating": {"list": [{"current": {"text": "Prometheus","value": "prometheus"},"description": "","label": "datasource","name": "ds","options": [],"query": "prometheus","refresh": 1,"regex": "","type": "datasource"},{"current": {"text": ["All"],"value": ["$__all"]},"datasource": {"type": "prometheus","uid": "${ds}"},"definition": "label_values(node_ipmi_power_watts,node_name)","description": "","includeAll": true,"label": "node","multi": true,"name": "no","options": [],"query": {"qryType": 1,"query": "label_values(node_ipmi_power_watts,node_name)","refId": "PrometheusVariableQueryEditor-VariableQuery"},"refresh": 1,"regex": "","type": "query"},{"current": {"text": ["All"],"value": ["$__all"]},"datasource": {"type": "prometheus","uid": "${ds}"},"definition": "label_values(kube_namespace_status_phase{job=\"kube-state-metrics\"},namespace)","description": "","includeAll": true,"label": "namespace","multi": true,"name": "ns","options": [],"query": {"qryType": 1,"query": "label_values(kube_namespace_status_phase{job=\"kube-state-metrics\"},namespace)","refId": "PrometheusVariableQueryEditor-VariableQuery"},"refresh": 1,"regex": "","sort": 1,"type": "query"},{"current": {"text": ["All"],"value": ["$__all"]},"datasource": {"type": "prometheus","uid": "${ds}"},"definition": "label_values(kube_pod_info{job=\"kube-state-metrics\", namespace=~\"$ns\", node=~\"$no\"},pod)","includeAll": true,"label": "pod","multi": true,"name": "pod","options": [],"query": {"qryType": 1,"query": "label_values(kube_pod_info{job=\"kube-state-metrics\", namespace=~\"$ns\", node=~\"$no\"},pod)","refId": "PrometheusVariableQueryEditor-VariableQuery"},"refresh": 1,"regex": "","type": "query"}]},"time": {"from": "now-15m","to": "now"},"timepicker": {},"timezone": "browser","title": "ee-bench","uid": "eeayt2o0nyq68b","version": 1,"weekStart": ""}'
kind: ConfigMap
metadata:
  labels:
    grafana_dashboard: "1"
  name: grafana-dashboard-ee-scheduling
